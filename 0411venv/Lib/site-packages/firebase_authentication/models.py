from django.db import models
from django.contrib.auth.models import AbstractUser
from django.utils.translation import gettext_lazy as _

from phonenumber_field.modelfields import PhoneNumberField

from .managers import UserManager

import uuid # 추가


__all__ = "User",

class User(AbstractUser):
    username = None
    first_name = None
    last_name = None
    email = None # emailId와 중복되는 field라 None 설정.

    # idToken에 해당
    id = models.UUIDField( # CharField -> UUIDField로 수정
        max_length=28,
        primary_key=True,
        db_index=True,
        unique=True,
        default=uuid.uuid4, # 추가
        editable=False, # 추가
    )
    emailId = models.EmailField( # email -> emailId로 수정
        _('email address'),
        unique=True,
        null=False,
        default="", # makemigrations가 안 되길래 default 지정
    )
    password = models.CharField(
        max_length=30,
        null=False,
        blank=False
    )

    EMAIL_FIELD = 'emailId'
    USERNAME_FIELD = 'emailId' # unique=True인 field만 USERNAME_FIELD로 설정 가능

    objects = UserManager()

    class Meta:
        verbose_name = _('user')
        verbose_name_plural = _('users')

    # 추가 # 필요없을 것 같으면 없애기.
    def get_email_field_name(self):
        return self.emailId
